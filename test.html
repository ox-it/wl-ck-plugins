<!DOCTYPE html>
<!--
Copyright (c) 2003-2014, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.md or http://ckeditor.com/license
-->
<html>
  <head>
    <meta charset="utf-8">
    <title>Weblearn CKEditor Widgets Sample</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://static.data.ox.ac.uk/courses-js-widget/courses-require.js"></script>
    <script src="http://static.data.ox.ac.uk/courses-js-widget/lib/require/require.js" data-main="courses"></script>
    <script src="lib/ckeditor/ckeditor.js"></script>
    <link rel="stylesheet" href="lib/ckeditor/samples/sample.css">
    <script>
      var editor, html = '';
      var scripts = document.getElementsByTagName("script");

      // getting absolute url of current file
      var src = scripts[scripts.length-1].baseURI.split('/');
          src.pop();
          src = src.join('/');

      function createEditor() {
        if (editor)
          return;

        // Create a new editor inside the <div id="editor">, setting its value to html
        var config = {};
        var path = CKEDITOR.basePath;
        editor = CKEDITOR.appendTo('editor', config, html);
        editor.config.allowedContent = true; // without this, all the 'data=' attributes get stripped

        // add the resource, then enabled it by adding it to extraPlugins
        CKEDITOR.plugins.addExternal('researcher-training-tool', src + '/researcher-training-tool/', 'plugin.js');
        editor.config.extraPlugins += 'researcher-training-tool,';

        // internal css (in the editor)
        editor.config.contentsCss = [
          src + '/researcher-training-tool/css/contents.css',
          'http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css',
        ];
      }

      function removeEditor() {
        if (!editor)
          return;

        // Retrieve the editor contents. In an Ajax application, this data would be
        // sent to the server or used in any other way.
        document.getElementById('editorcontents').innerHTML = html = editor.getData();
        document.getElementById('contents').style.display = '';

        // Destroy the editor.
        editor.destroy();
        editor = null;
      }
    </script>
  </head>
  <body>
    <h1 class="samples">
      <a href="index.html">CKEditor Samples</a> &raquo; Create and Destroy Editor Instances for Ajax Applications
    </h1>
    <div class="description">
      <p>
        Note that occasionally the Youtube dialog iframe will fail to load and the following error will be logged to the console:
        <code>Synchronous XMLHttpRequest on the main thread is deprecated because of its detrimental effects to the end user's experience. For more help http://xhr.spec.whatwg.org/</code>
      </p>
    </div>
    <p>Click the buttons to create and remove a CKEditor instance.</p>
    <p>
      <input onclick="createEditor();" type="button" value="Create Editor">
      <input onclick="removeEditor();" type="button" value="Remove Editor">
    </p>
    <!-- This div will hold the editor. -->
    <div id="editor">
    </div>
    <div id="contents" style="display: none">
      <p>
          Edited Contents:
      </p>
      <!-- This div will be used to display the editor contents. -->
      <div id="editorcontents">
      </div>
    </div>
    <div id="footer">
      <hr>
      <p>
        CKEditor - The text editor for the Internet - <a class="samples" href="http://ckeditor.com/">http://ckeditor.com</a>
      </p>
      <p id="copy">
        Copyright &copy; 2003-2014, <a class="samples" href="http://cksource.com/">CKSource</a> - Frederico
        Knabben. All rights reserved.
      </p>
    </div>
  </body>
</html>
